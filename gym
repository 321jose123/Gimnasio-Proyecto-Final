--
-- PostgreSQL database dump
--

\restrict Xh3KKVLhZ2vWzVE5A0T3Jj72qDVJySU8Ike71fOAbE3FsTWw63RvOAEOwsevfAN

-- Dumped from database version 16.10 (Ubuntu 16.10-0ubuntu0.24.04.1)
-- Dumped by pg_dump version 16.10 (Ubuntu 16.10-0ubuntu0.24.04.1)

-- Started on 2025-11-10 21:14:52 -05

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

--
-- TOC entry 234 (class 1255 OID 32930)
-- Name: set_default_group(); Type: FUNCTION; Schema: public; Owner: postgres
--

CREATE FUNCTION public.set_default_group() RETURNS trigger
    LANGUAGE plpgsql
    AS $$
BEGIN
    IF NEW.group_id IS NULL THEN
        NEW.group_id := (SELECT id FROM public.groups WHERE group_name = 'usuario');
    END IF;
    RETURN NEW;
END;
$$;


ALTER FUNCTION public.set_default_group() OWNER TO postgres;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- TOC entry 215 (class 1259 OID 32931)
-- Name: access_devices; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.access_devices (
    device_id integer NOT NULL,
    device_name text NOT NULL,
    ip_address inet NOT NULL,
    status boolean DEFAULT true,
    last_communication timestamp with time zone DEFAULT now()
);


ALTER TABLE public.access_devices OWNER TO postgres;

--
-- TOC entry 216 (class 1259 OID 32938)
-- Name: access_devices_device_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.access_devices_device_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.access_devices_device_id_seq OWNER TO postgres;

--
-- TOC entry 3611 (class 0 OID 0)
-- Dependencies: 216
-- Name: access_devices_device_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.access_devices_device_id_seq OWNED BY public.access_devices.device_id;


--
-- TOC entry 227 (class 1259 OID 33129)
-- Name: access_logs; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.access_logs (
    id bigint NOT NULL,
    employee_no text NOT NULL,
    name text,
    ticket_id bigint,
    access_time timestamp with time zone DEFAULT now() NOT NULL,
    door_no integer,
    accesses_before integer,
    accesses_after integer,
    serial_no text
);


ALTER TABLE public.access_logs OWNER TO postgres;

--
-- TOC entry 226 (class 1259 OID 33128)
-- Name: access_logs_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.access_logs ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.access_logs_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 229 (class 1259 OID 33167)
-- Name: access_ticket_logs; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.access_ticket_logs (
    id bigint NOT NULL,
    employee_no text NOT NULL,
    name text,
    ticket_id bigint NOT NULL,
    access_time timestamp with time zone DEFAULT now() NOT NULL,
    door_no integer,
    accesses_before integer,
    accesses_after integer,
    serial_no text
);


ALTER TABLE public.access_ticket_logs OWNER TO postgres;

--
-- TOC entry 228 (class 1259 OID 33166)
-- Name: access_ticket_logs_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.access_ticket_logs ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.access_ticket_logs_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 217 (class 1259 OID 32939)
-- Name: eventos_accesos; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.eventos_accesos (
    id bigint NOT NULL,
    employee_no text NOT NULL,
    nombre text,
    card_no text,
    "timestamp" timestamp with time zone DEFAULT now() NOT NULL,
    door_no integer,
    serial_no bigint,
    user_type text,
    verify_mode text,
    mask_status text,
    picture_url text,
    suscripcion character varying
);


ALTER TABLE public.eventos_accesos OWNER TO postgres;

--
-- TOC entry 218 (class 1259 OID 32945)
-- Name: eventos_accesos_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.eventos_accesos_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.eventos_accesos_id_seq OWNER TO postgres;

--
-- TOC entry 3612 (class 0 OID 0)
-- Dependencies: 218
-- Name: eventos_accesos_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.eventos_accesos_id_seq OWNED BY public.eventos_accesos.id;


--
-- TOC entry 219 (class 1259 OID 32946)
-- Name: groups; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.groups (
    id bigint NOT NULL,
    group_name text NOT NULL
);


ALTER TABLE public.groups OWNER TO postgres;

--
-- TOC entry 220 (class 1259 OID 32951)
-- Name: groups_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.groups ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.groups_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 233 (class 1259 OID 33206)
-- Name: informes; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.informes (
    id integer NOT NULL,
    employee_no character varying(255) NOT NULL,
    name character varying(255),
    user_type character varying(100),
    suscripcion character varying(100),
    registration_date timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
    clase integer DEFAULT 0
);


ALTER TABLE public.informes OWNER TO postgres;

--
-- TOC entry 232 (class 1259 OID 33205)
-- Name: informes_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.informes_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.informes_id_seq OWNER TO postgres;

--
-- TOC entry 3613 (class 0 OID 0)
-- Dependencies: 232
-- Name: informes_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.informes_id_seq OWNED BY public.informes.id;


--
-- TOC entry 231 (class 1259 OID 33184)
-- Name: ticket_accesos; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.ticket_accesos (
    id integer NOT NULL,
    employee_no character varying(50) NOT NULL,
    nombre character varying(255),
    card_no character varying(100),
    "timestamp" timestamp without time zone DEFAULT CURRENT_TIMESTAMP NOT NULL,
    door_no character varying(50),
    serial_no character varying(100),
    user_type character varying(50),
    verify_mode character varying(50),
    mask_status character varying(50),
    picture_url text
);


ALTER TABLE public.ticket_accesos OWNER TO postgres;

--
-- TOC entry 230 (class 1259 OID 33183)
-- Name: ticket_accesos_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

CREATE SEQUENCE public.ticket_accesos_id_seq
    AS integer
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1;


ALTER SEQUENCE public.ticket_accesos_id_seq OWNER TO postgres;

--
-- TOC entry 3614 (class 0 OID 0)
-- Dependencies: 230
-- Name: ticket_accesos_id_seq; Type: SEQUENCE OWNED BY; Schema: public; Owner: postgres
--

ALTER SEQUENCE public.ticket_accesos_id_seq OWNED BY public.ticket_accesos.id;


--
-- TOC entry 225 (class 1259 OID 33092)
-- Name: ticket_user; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.ticket_user (
    id bigint NOT NULL,
    employee_no text NOT NULL,
    name text,
    gender text,
    face_image text,
    classes_purchased integer NOT NULL,
    accesos_disponibles integer NOT NULL,
    purchase_date timestamp with time zone DEFAULT now() NOT NULL,
    expiration_date timestamp with time zone NOT NULL,
    activation boolean DEFAULT true NOT NULL,
    door_no integer DEFAULT 1,
    door_right text DEFAULT '1'::text,
    nota text,
    group_id bigint
);


ALTER TABLE public.ticket_user OWNER TO postgres;

--
-- TOC entry 224 (class 1259 OID 33091)
-- Name: ticket_user_id_seq; Type: SEQUENCE; Schema: public; Owner: postgres
--

ALTER TABLE public.ticket_user ALTER COLUMN id ADD GENERATED ALWAYS AS IDENTITY (
    SEQUENCE NAME public.ticket_user_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- TOC entry 221 (class 1259 OID 32952)
-- Name: user_cards; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.user_cards (
    employee_no text NOT NULL,
    card_no text NOT NULL,
    delete_card boolean,
    card_type text,
    check_card_no boolean,
    check_employee_no boolean,
    add_card boolean
);


ALTER TABLE public.user_cards OWNER TO postgres;

--
-- TOC entry 222 (class 1259 OID 32957)
-- Name: user_images; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.user_images (
    employee_no text NOT NULL,
    img64 text
);


ALTER TABLE public.user_images OWNER TO postgres;

--
-- TOC entry 223 (class 1259 OID 32962)
-- Name: users; Type: TABLE; Schema: public; Owner: postgres
--

CREATE TABLE public.users (
    employee_no text NOT NULL,
    name text,
    user_type text,
    door_right text,
    local_ui_user_type text,
    user_verify_mode text,
    add_user boolean,
    gender text,
    valid_enable boolean,
    valid_begin_time timestamp with time zone,
    valid_end_time timestamp with time zone,
    door_no integer,
    plan_template_no text,
    email text,
    phone_number text,
    address text,
    city text,
    country text,
    date_of_birth date,
    registration_date timestamp with time zone DEFAULT CURRENT_TIMESTAMP,
    active boolean DEFAULT true,
    face_image text,
    group_id bigint,
    nota text,
    suscripcion character varying,
    accesos_disponibles integer DEFAULT 0,
    acc_diarios integer DEFAULT 0,
    CONSTRAINT check_acc_diarios CHECK (((acc_diarios >= 0) AND (acc_diarios <= 2))),
    CONSTRAINT users_accesos_disponibles_check CHECK ((accesos_disponibles >= 0))
);


ALTER TABLE public.users OWNER TO postgres;

--
-- TOC entry 3373 (class 2604 OID 32973)
-- Name: access_devices device_id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.access_devices ALTER COLUMN device_id SET DEFAULT nextval('public.access_devices_device_id_seq'::regclass);


--
-- TOC entry 3376 (class 2604 OID 32974)
-- Name: eventos_accesos id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eventos_accesos ALTER COLUMN id SET DEFAULT nextval('public.eventos_accesos_id_seq'::regclass);


--
-- TOC entry 3390 (class 2604 OID 33209)
-- Name: informes id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.informes ALTER COLUMN id SET DEFAULT nextval('public.informes_id_seq'::regclass);


--
-- TOC entry 3388 (class 2604 OID 33187)
-- Name: ticket_accesos id; Type: DEFAULT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ticket_accesos ALTER COLUMN id SET DEFAULT nextval('public.ticket_accesos_id_seq'::regclass);


--
-- TOC entry 3587 (class 0 OID 32931)
-- Dependencies: 215
-- Data for Name: access_devices; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.access_devices (device_id, device_name, ip_address, status, last_communication) FROM stdin;
\.


--
-- TOC entry 3599 (class 0 OID 33129)
-- Dependencies: 227
-- Data for Name: access_logs; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.access_logs (id, employee_no, name, ticket_id, access_time, door_no, accesses_before, accesses_after, serial_no) FROM stdin;
\.


--
-- TOC entry 3601 (class 0 OID 33167)
-- Dependencies: 229
-- Data for Name: access_ticket_logs; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.access_ticket_logs (id, employee_no, name, ticket_id, access_time, door_no, accesses_before, accesses_after, serial_no) FROM stdin;
\.


--
-- TOC entry 3589 (class 0 OID 32939)
-- Dependencies: 217
-- Data for Name: eventos_accesos; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.eventos_accesos (id, employee_no, nombre, card_no, "timestamp", door_no, serial_no, user_type, verify_mode, mask_status, picture_url, suscripcion) FROM stdin;
\.


--
-- TOC entry 3591 (class 0 OID 32946)
-- Dependencies: 219
-- Data for Name: groups; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.groups (id, group_name) FROM stdin;
1	Entrenamiento personal
2	ticketera
\.


--
-- TOC entry 3605 (class 0 OID 33206)
-- Dependencies: 233
-- Data for Name: informes; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.informes (id, employee_no, name, user_type, suscripcion, registration_date, clase) FROM stdin;
\.


--
-- TOC entry 3603 (class 0 OID 33184)
-- Dependencies: 231
-- Data for Name: ticket_accesos; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.ticket_accesos (id, employee_no, nombre, card_no, "timestamp", door_no, serial_no, user_type, verify_mode, mask_status, picture_url) FROM stdin;
\.


--
-- TOC entry 3597 (class 0 OID 33092)
-- Dependencies: 225
-- Data for Name: ticket_user; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.ticket_user (id, employee_no, name, gender, face_image, classes_purchased, accesos_disponibles, purchase_date, expiration_date, activation, door_no, door_right, nota, group_id) FROM stdin;
\.


--
-- TOC entry 3593 (class 0 OID 32952)
-- Dependencies: 221
-- Data for Name: user_cards; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.user_cards (employee_no, card_no, delete_card, card_type, check_card_no, check_employee_no, add_card) FROM stdin;
\.


--
-- TOC entry 3594 (class 0 OID 32957)
-- Dependencies: 222
-- Data for Name: user_images; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.user_images (employee_no, img64) FROM stdin;
\.


--
-- TOC entry 3595 (class 0 OID 32962)
-- Dependencies: 223
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: postgres
--

COPY public.users (employee_no, name, user_type, door_right, local_ui_user_type, user_verify_mode, add_user, gender, valid_enable, valid_begin_time, valid_end_time, door_no, plan_template_no, email, phone_number, address, city, country, date_of_birth, registration_date, active, face_image, group_id, nota, suscripcion, accesos_disponibles, acc_diarios) FROM stdin;
\.


--
-- TOC entry 3615 (class 0 OID 0)
-- Dependencies: 216
-- Name: access_devices_device_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.access_devices_device_id_seq', 1, false);


--
-- TOC entry 3616 (class 0 OID 0)
-- Dependencies: 226
-- Name: access_logs_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.access_logs_id_seq', 1, false);


--
-- TOC entry 3617 (class 0 OID 0)
-- Dependencies: 228
-- Name: access_ticket_logs_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.access_ticket_logs_id_seq', 1721, true);


--
-- TOC entry 3618 (class 0 OID 0)
-- Dependencies: 218
-- Name: eventos_accesos_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.eventos_accesos_id_seq', 38455, true);


--
-- TOC entry 3619 (class 0 OID 0)
-- Dependencies: 220
-- Name: groups_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.groups_id_seq', 2, true);


--
-- TOC entry 3620 (class 0 OID 0)
-- Dependencies: 232
-- Name: informes_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.informes_id_seq', 11, true);


--
-- TOC entry 3621 (class 0 OID 0)
-- Dependencies: 230
-- Name: ticket_accesos_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.ticket_accesos_id_seq', 1827, true);


--
-- TOC entry 3622 (class 0 OID 0)
-- Dependencies: 224
-- Name: ticket_user_id_seq; Type: SEQUENCE SET; Schema: public; Owner: postgres
--

SELECT pg_catalog.setval('public.ticket_user_id_seq', 33, true);


--
-- TOC entry 3396 (class 2606 OID 32976)
-- Name: access_devices access_devices_ip_address_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.access_devices
    ADD CONSTRAINT access_devices_ip_address_key UNIQUE (ip_address);


--
-- TOC entry 3398 (class 2606 OID 32978)
-- Name: access_devices access_devices_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.access_devices
    ADD CONSTRAINT access_devices_pkey PRIMARY KEY (device_id);


--
-- TOC entry 3423 (class 2606 OID 33136)
-- Name: access_logs access_logs_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.access_logs
    ADD CONSTRAINT access_logs_pkey PRIMARY KEY (id);


--
-- TOC entry 3425 (class 2606 OID 33138)
-- Name: access_logs access_logs_serial_no_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.access_logs
    ADD CONSTRAINT access_logs_serial_no_key UNIQUE (serial_no);


--
-- TOC entry 3428 (class 2606 OID 33174)
-- Name: access_ticket_logs access_ticket_logs_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.access_ticket_logs
    ADD CONSTRAINT access_ticket_logs_pkey PRIMARY KEY (id);


--
-- TOC entry 3430 (class 2606 OID 33176)
-- Name: access_ticket_logs access_ticket_logs_serial_no_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.access_ticket_logs
    ADD CONSTRAINT access_ticket_logs_serial_no_key UNIQUE (serial_no);


--
-- TOC entry 3401 (class 2606 OID 32980)
-- Name: eventos_accesos eventos_accesos_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eventos_accesos
    ADD CONSTRAINT eventos_accesos_pkey PRIMARY KEY (id);


--
-- TOC entry 3403 (class 2606 OID 32982)
-- Name: eventos_accesos eventos_accesos_serial_no_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eventos_accesos
    ADD CONSTRAINT eventos_accesos_serial_no_key UNIQUE (serial_no);


--
-- TOC entry 3405 (class 2606 OID 32984)
-- Name: groups groups_group_name_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.groups
    ADD CONSTRAINT groups_group_name_key UNIQUE (group_name);


--
-- TOC entry 3407 (class 2606 OID 32986)
-- Name: groups groups_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.groups
    ADD CONSTRAINT groups_pkey PRIMARY KEY (id);


--
-- TOC entry 3435 (class 2606 OID 33214)
-- Name: informes informes_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.informes
    ADD CONSTRAINT informes_pkey PRIMARY KEY (id);


--
-- TOC entry 3433 (class 2606 OID 33192)
-- Name: ticket_accesos ticket_accesos_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ticket_accesos
    ADD CONSTRAINT ticket_accesos_pkey PRIMARY KEY (id);


--
-- TOC entry 3419 (class 2606 OID 33104)
-- Name: ticket_user ticket_user_employee_no_key; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ticket_user
    ADD CONSTRAINT ticket_user_employee_no_key UNIQUE (employee_no);


--
-- TOC entry 3421 (class 2606 OID 33102)
-- Name: ticket_user ticket_user_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ticket_user
    ADD CONSTRAINT ticket_user_pkey PRIMARY KEY (id);


--
-- TOC entry 3413 (class 2606 OID 32988)
-- Name: users unique_email; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT unique_email UNIQUE (email);


--
-- TOC entry 3415 (class 2606 OID 32990)
-- Name: users unique_phone_number; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT unique_phone_number UNIQUE (phone_number);


--
-- TOC entry 3409 (class 2606 OID 32992)
-- Name: user_cards user_cards_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_cards
    ADD CONSTRAINT user_cards_pkey PRIMARY KEY (employee_no);


--
-- TOC entry 3411 (class 2606 OID 32994)
-- Name: user_images user_images_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_images
    ADD CONSTRAINT user_images_pkey PRIMARY KEY (employee_no);


--
-- TOC entry 3417 (class 2606 OID 32996)
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (employee_no);


--
-- TOC entry 3399 (class 1259 OID 32997)
-- Name: idx_access_devices_ip; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_access_devices_ip ON public.access_devices USING btree (ip_address);


--
-- TOC entry 3426 (class 1259 OID 33144)
-- Name: idx_access_logs_employee_no; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_access_logs_employee_no ON public.access_logs USING btree (employee_no);


--
-- TOC entry 3431 (class 1259 OID 33182)
-- Name: idx_access_ticket_logs_employee_no; Type: INDEX; Schema: public; Owner: postgres
--

CREATE INDEX idx_access_ticket_logs_employee_no ON public.access_ticket_logs USING btree (employee_no);


--
-- TOC entry 3443 (class 2620 OID 32998)
-- Name: users set_default_group_trigger; Type: TRIGGER; Schema: public; Owner: postgres
--

CREATE TRIGGER set_default_group_trigger BEFORE INSERT ON public.users FOR EACH ROW EXECUTE FUNCTION public.set_default_group();


--
-- TOC entry 3440 (class 2606 OID 33139)
-- Name: access_logs access_logs_ticket_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.access_logs
    ADD CONSTRAINT access_logs_ticket_id_fkey FOREIGN KEY (ticket_id) REFERENCES public.ticket_user(id) ON DELETE SET NULL;


--
-- TOC entry 3441 (class 2606 OID 33177)
-- Name: access_ticket_logs access_ticket_logs_ticket_id_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.access_ticket_logs
    ADD CONSTRAINT access_ticket_logs_ticket_id_fkey FOREIGN KEY (ticket_id) REFERENCES public.ticket_user(id) ON DELETE CASCADE;


--
-- TOC entry 3436 (class 2606 OID 32999)
-- Name: eventos_accesos eventos_accesos_employee_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.eventos_accesos
    ADD CONSTRAINT eventos_accesos_employee_fkey FOREIGN KEY (employee_no) REFERENCES public.users(employee_no) ON DELETE CASCADE;


--
-- TOC entry 3442 (class 2606 OID 33193)
-- Name: ticket_accesos ticket_accesos_employee_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.ticket_accesos
    ADD CONSTRAINT ticket_accesos_employee_fkey FOREIGN KEY (employee_no) REFERENCES public.ticket_user(employee_no) ON DELETE CASCADE;


--
-- TOC entry 3437 (class 2606 OID 33004)
-- Name: user_cards user_cards_employee_no_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_cards
    ADD CONSTRAINT user_cards_employee_no_fkey FOREIGN KEY (employee_no) REFERENCES public.users(employee_no) ON DELETE CASCADE;


--
-- TOC entry 3438 (class 2606 OID 33009)
-- Name: user_images user_images_employee_no_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.user_images
    ADD CONSTRAINT user_images_employee_no_fkey FOREIGN KEY (employee_no) REFERENCES public.users(employee_no);


--
-- TOC entry 3439 (class 2606 OID 33014)
-- Name: users users_group_fkey; Type: FK CONSTRAINT; Schema: public; Owner: postgres
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_group_fkey FOREIGN KEY (group_id) REFERENCES public.groups(id) ON DELETE SET DEFAULT;


-- Completed on 2025-11-10 21:14:52 -05

--
-- PostgreSQL database dump complete
--

\unrestrict Xh3KKVLhZ2vWzVE5A0T3Jj72qDVJySU8Ike71fOAbE3FsTWw63RvOAEOwsevfAN

